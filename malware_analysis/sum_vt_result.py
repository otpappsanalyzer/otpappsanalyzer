import os
import pandas as pd 
import json

result_path = '/home/budi/OTP_project/OTP_code/mobsf_analysis/mobsf_result/'

mal_detect=[]
for root,dirs,files in os.walk(result_path):
    for file in files:
        res_file_path = root+file
        with open (res_file_path,'r') as fp:
            try:
                data = fp.read()
                json_data = json.loads(data)
                json_VT = json_data['virus_total']['scans']
                for item in json_VT:
                    if json_VT[item]['detected'] == True:
                        print(file,item,json_VT[item])
            except:
                # print('virus total error --------------------------------'+file)
                # item_list = {'path':app_file_path,'file':file}
                # app_to_analyze.append(item_list)
                pass


# app_to_analyze_path = oversize_path+'app_to_analyze.csv'
# df_to_analyze = pd.DataFrame(app_to_analyze)
# df_to_analyze.to_csv(app_to_analyze_path,index=False)